<?php extendView('layouts/default.phtml'); ?>

<div class="roadmap content">
	<div class="flex">
		<h2 class="page-title flex-grow"><?= l('roadmap') ?></h2>
		<div class="flex items-center gap-4">
			<?= View::render('projects/_roadmap_sort', ['sort' => $sort, 'order' => $order]) ?>
			<div class="btn-pill-group mt-2">
				<a href="<?= Request::base($project->href('roadmap')) ?>" class="<?= active_nav('/:slug/roadmap') ? 'active' : '' ?>"><?= l('active') ?></a>
				<a href="<?= Request::base($project->href('roadmap/completed')) ?>" class="<?= active_nav('/:slug/roadmap/completed') ? 'active' : '' ?>"><?= l('completed') ?></a>
				<a href="<?= Request::base($project->href('roadmap/all')) ?>" class="<?= active_nav('/:slug/roadmap/all') ? 'active' : '' ?>"><?= l('all') ?></a>
			</div>
		</div>
	</div>

	<?php foreach ($milestoneData as $row): ?>
		<div class="milestone">
			<div class="milestone-content">
				<div class="flex-1">
					<div class="milestone-header">
						<div>
							<a href="<?= Request::base($row['milestone']->href()) ?>">
								<h2 class="milestone-name">
									<?= $row['milestone']->name ?>
									<?php if ($row['milestone']->codename): ?>
										<em>"<?= $row['milestone']->codename ?>"</em>
									<?php endif; ?>
								</h2>
							</a>

							<?php if ($row['milestone']->due > 0 and $row['milestone']->status == 1): ?>
								<div class="milestone-due">
									<em><?= l('due_x', time_from_now_ago($row['milestone']->due)) ?></em>
								</div>
							<?php endif; ?>
						</div>
						<?php if ($row['is_started'] == 1): ?>
							<span class="text-xs font-semibold uppercase tracking-wider text-emerald-600 bg-emerald-50 px-2 py-1 rounded"><?= l('active_development') ?></span>
						<?php elseif ($row['milestone']->status == 0): ?>
							<span class="text-xs font-semibold uppercase tracking-wider text-slate-600 bg-slate-50 px-2 py-1 rounded"><?= l('cancelled') ?></span>
						<?php endif; ?>
					</div>
					<?= View::render('milestones/_progress', ['row' => $row]) ?>
				</div>

				<div class="milestone-info">
					<?= format_text($row['milestone']->info) ?>
				</div>
			</div>
		</div>
	<?php endforeach; ?>
</div>
